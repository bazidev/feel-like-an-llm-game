<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sound & API Tester - Feel like an LLM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .panels {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 968px) {
            .panels {
                grid-template-columns: 1fr;
            }
        }

        .panel {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .panel h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .sound-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .sound-btn {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .sound-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .sound-btn:active {
            transform: translateY(0);
        }

        .api-section {
            margin-top: 25px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .action-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.6);
        }

        .action-btn:active {
            transform: translateY(0);
        }

        .action-btn.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        .action-btn.danger:hover {
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.6);
        }

        .action-btn.secondary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.4);
        }

        .action-btn.secondary:hover {
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.6);
        }

        .response-box {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .response-box pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .leaderboard-table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }

        .leaderboard-table th,
        .leaderboard-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .leaderboard-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #667eea;
        }

        .leaderboard-table tr:hover {
            background: #f8f9fa;
        }

        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-success {
            background: #10b981;
        }

        .status-error {
            background: #ef4444;
        }

        .status-info {
            background: #3b82f6;
        }

        .btn-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .loading {
            opacity: 0.6;
            cursor: not-allowed;
            pointer-events: none;
        }

        .info-box {
            background: #e0e7ff;
            border-left: 4px solid #667eea;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .info-box p {
            margin: 5px 0;
            color: #3730a3;
            font-size: 14px;
        }

        .random-data-preview {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 13px;
        }

        .random-data-preview strong {
            color: #92400e;
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 20px 25px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 12px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .toast.success {
            border-left: 4px solid #10b981;
        }

        .toast.error {
            border-left: 4px solid #ef4444;
        }

        .count-badge {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ Sound & API Tester</h1>

        <div class="panels">
            <!-- Sound Testing Panel -->
            <div class="panel">
                <h2>üîä Sound Effects Tester</h2>
                <div class="info-box">
                    <p><strong>Available Sounds:</strong> 11 sound effects</p>
                    <p><strong>Library:</strong> Howler.js with Web Audio API fallback</p>
                    <p>Click any button below to test the sound</p>
                </div>
                
                <h3 style="color: #764ba2; margin-bottom: 10px; font-size: 1.2em;">Basic Sounds</h3>
                <div class="sound-buttons">
                    <button class="sound-btn" onclick="testSound('success')">
                        ‚úÖ Success
                    </button>
                    <button class="sound-btn" onclick="testSound('error')">
                        ‚ùå Error
                    </button>
                    <button class="sound-btn" onclick="testSound('click')">
                        üëÜ Click
                    </button>
                    <button class="sound-btn" onclick="testSound('hover')">
                        üñ±Ô∏è Hover
                    </button>
                </div>

                <h3 style="color: #764ba2; margin: 20px 0 10px 0; font-size: 1.2em;">Feedback Sounds</h3>
                <div class="sound-buttons">
                    <button class="sound-btn" onclick="testSound('correct')">
                        ‚úîÔ∏è Correct
                    </button>
                    <button class="sound-btn" onclick="testSound('wrong')">
                        ‚ùå Wrong
                    </button>
                    <button class="sound-btn" onclick="testSound('warning')">
                        ‚ö†Ô∏è Warning
                    </button>
                    <button class="sound-btn" onclick="testSound('timeout')">
                        ‚è±Ô∏è Timeout
                    </button>
                </div>

                <h3 style="color: #764ba2; margin: 20px 0 10px 0; font-size: 1.2em;">Game Sounds</h3>
                <div class="sound-buttons">
                    <button class="sound-btn" onclick="testSound('levelUp')">
                        üéâ Level Up
                    </button>
                    <button class="sound-btn" onclick="testSound('victory')">
                        üèÜ Victory
                    </button>
                    <button class="sound-btn" onclick="testSound('powerup')">
                        üí´ Powerup
                    </button>
                    <button class="sound-btn" onclick="testSound('coin')">
                        ü™ô Coin
                    </button>
                    <button class="sound-btn" onclick="testSound('notification')">
                        üîî Notification
                    </button>
                </div>

                <div class="btn-group" style="margin-top: 30px;">
                    <button class="action-btn secondary" onclick="testAllSounds()">
                        üéº Play All
                    </button>
                    <button class="action-btn danger" onclick="toggleMute()">
                        <span id="muteText">üîá Mute</span>
                    </button>
                </div>

                <div class="response-box" id="soundLog">
                    <strong>Sound Log:</strong><br>
                    Ready to test sounds...
                </div>
            </div>

            <!-- API Testing Panel -->
            <div class="panel">
                <h2>üöÄ Scoreboard API Tester</h2>
                <div class="info-box">
                    <p><strong>Game:</strong> Feel like an LLM</p>
                    <p><strong>Backend:</strong> Parse/Back4App</p>
                    <p>Test saving and fetching scores</p>
                </div>

                <div class="api-section">
                    <h3 style="color: #764ba2; margin-bottom: 15px;">Generate & Save Random Score</h3>
                    
                    <div class="form-group">
                        <label>User Name (Unique ID):
                            <button onclick="toggleUserNameEdit()" style="margin-left: 10px; padding: 4px 12px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 12px;">
                                ‚úèÔ∏è Edit
                            </button>
                        </label>
                        <input type="text" id="userName" placeholder="e.g., user_1762620810074_4315" readonly style="background: #f8f9fa;">
                    </div>

                    <div class="form-group">
                        <label>Display Name:</label>
                        <input type="text" id="displayName" placeholder="e.g., GPT-7 Turbo">
                    </div>

                    <div class="form-group">
                        <label>Avatar:</label>
                        <select id="avatar">
                            <option value="robot">ü§ñ Robot</option>
                            <option value="alien">üëΩ Alien</option>
                            <option value="brain">üß† Brain</option>
                            <option value="rocket">üöÄ Rocket</option>
                            <option value="star">‚≠ê Star</option>
                            <option value="fire">üî• Fire</option>
                        </select>
                    </div>

                    <div class="random-data-preview" id="randomPreview">
                        Click "Generate Random Data" to see what will be sent
                    </div>

                    <div class="btn-group">
                        <button class="action-btn secondary" onclick="generateRandomData()">
                            üé≤ Generate Random Data
                        </button>
                        <button class="action-btn" onclick="saveScore()" id="saveBtn">
                            üíæ Save Score
                        </button>
                    </div>

                    <button class="action-btn secondary" onclick="getLeaderboard()" style="margin-top: 10px;">
                        üèÜ Get Leaderboard
                    </button>

                    <div class="response-box" id="apiResponse">
                        <strong>API Response:</strong><br>
                        Ready to test API...
                    </div>
                </div>
            </div>
        </div>

        <!-- Full Width Leaderboard Panel -->
        <div class="panel">
            <h2>üèÜ Leaderboard <span class="count-badge" id="leaderboardCount">0</span></h2>
            <div id="leaderboardContent">
                <p style="text-align: center; color: #999; padding: 40px;">
                    Click "Get Leaderboard" to fetch scores
                </p>
            </div>
        </div>
    </div>

    <!-- Include sound manager -->
    <script src="sounds.js"></script>
    <script src="scoreboard-api.js"></script>

    <script>
        // Mock Game state for testing
        const Game = {
            state: {
                uniqueUserId: null,
                modelName: null,
                avatar: 'robot',
                score: 0,
                startTime: Date.now()
            }
        };

        // Random data generators
        const randomNames = [
            'GPT-7 Turbo', 'Claude Ultra', 'LLaMA Supreme', 'PaLM Mega', 
            'Gemini Pro', 'Mixtral Elite', 'Falcon Extreme', 'Bloom Master',
            'BERT Champion', 'T5 Legend', 'XLNet Titan', 'RoBERTa King',
            'ELECTRA Boss', 'ALBERT Wizard', 'DeBERTa Hero', 'Megatron Commander'
        ];

        const randomAvatars = ['robot', 'alien', 'brain', 'rocket', 'star', 'fire'];

        function generateRandomUserId() {
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 10000);
            return `user_${timestamp}_${random}`;
        }

        function generateRandomScore() {
            // Generate realistic score between 100 and 5000
            return Math.floor(Math.random() * 4900) + 100;
        }

        function generateRandomTime() {
            // Generate random play time between 30 seconds and 10 minutes
            return Math.floor(Math.random() * 570) + 30;
        }

        function generateRandomData() {
            // Generate all random data
            const randomName = randomNames[Math.floor(Math.random() * randomNames.length)];
            const randomAvatar = randomAvatars[Math.floor(Math.random() * randomAvatars.length)];
            const randomScore = generateRandomScore();
            const randomUserId = generateRandomUserId();
            const randomTime = generateRandomTime();

            // Set the form fields
            document.getElementById('userName').value = randomUserId;
            document.getElementById('displayName').value = randomName;
            document.getElementById('avatar').value = randomAvatar;

            // Update Game state
            Game.state.uniqueUserId = randomUserId;
            Game.state.modelName = randomName;
            Game.state.avatar = randomAvatar;
            Game.state.score = randomScore;
            Game.state.startTime = Date.now() - (randomTime * 1000);

            // Show preview
            const preview = document.getElementById('randomPreview');
            preview.innerHTML = `
                <strong>Generated Data:</strong><br>
                <strong>User Name:</strong> ${randomUserId}<br>
                <strong>Display Name:</strong> ${randomName}<br>
                <strong>Avatar:</strong> ${randomAvatar}<br>
                <strong>Score:</strong> ${randomScore}<br>
                <strong>Play Time:</strong> ${randomTime}s<br>
            `;

            logSound('Generated random data for testing');
            showToast('Random data generated!', 'success');
        }

        // Sound Testing Functions
        function testSound(soundName) {
            logSound(`Playing: ${soundName}`);
            SoundManager.play(soundName);
            showToast(`Playing ${soundName} sound`, 'success');
        }

        function testAllSounds() {
            const sounds = ['click', 'hover', 'success', 'correct', 'error', 'wrong', 'warning', 'timeout', 'coin', 'notification', 'powerup', 'levelUp', 'victory'];
            let index = 0;

            logSound('Playing all sounds in sequence...');

            const playNext = () => {
                if (index < sounds.length) {
                    const sound = sounds[index];
                    logSound(`Playing: ${sound}`);
                    SoundManager.play(sound);
                    index++;
                    setTimeout(playNext, 600);
                } else {
                    logSound('All sounds played! üéâ');
                }
            };

            playNext();
        }

        function toggleMute() {
            const isMuted = SoundManager.toggle();
            document.getElementById('muteText').textContent = isMuted ? 'üîä Unmute' : 'üîá Mute';
            logSound(`Sound ${isMuted ? 'muted' : 'unmuted'}`);
            showToast(isMuted ? 'Sound muted' : 'Sound unmuted', 'success');
        }

        function logSound(message) {
            const log = document.getElementById('soundLog');
            const timestamp = new Date().toLocaleTimeString();
            log.innerHTML += `<br>[${timestamp}] ${message}`;
            log.scrollTop = log.scrollHeight;
        }

        // API Testing Functions
        function toggleUserNameEdit() {
            const userNameField = document.getElementById('userName');
            if (userNameField.readOnly) {
                userNameField.readOnly = false;
                userNameField.style.background = 'white';
                userNameField.focus();
                showToast('User name field is now editable', 'success');
            } else {
                userNameField.readOnly = true;
                userNameField.style.background = '#f8f9fa';
                showToast('User name field locked', 'success');
            }
        }

        async function saveScore() {
            const userName = document.getElementById('userName').value;
            const displayName = document.getElementById('displayName').value;
            const avatar = document.getElementById('avatar').value;

            if (!userName) {
                showToast('Please generate random data first or enter a user name', 'error');
                return;
            }

            if (!displayName) {
                showToast('Please enter a display name', 'error');
                return;
            }

            // Update Game state with form values
            Game.state.uniqueUserId = userName;
            Game.state.modelName = displayName;
            Game.state.avatar = avatar;

            const btn = document.getElementById('saveBtn');
            btn.classList.add('loading');
            btn.textContent = '‚è≥ Saving...';

            logApi('Attempting to save score...');
            logApi(`User Name: ${Game.state.uniqueUserId}`);
            logApi(`Display Name: ${Game.state.modelName}`);
            logApi(`Score: ${Game.state.score}`);

            try {
                const result = await ScoreboardAPI.saveScore();
                
                logApi('Response received:');
                logApi(JSON.stringify(result, null, 2));

                if (result.success) {
                    showToast('Score saved successfully!', 'success');
                    SoundManager.play('success');
                    
                    if (result.isHighScore) {
                        logApi('üéâ New high score!');
                    }
                } else {
                    showToast(`Failed to save: ${result.error}`, 'error');
                    SoundManager.play('error');
                    
                    if (result.details) {
                        logApi('Error details: ' + JSON.stringify(result.details, null, 2));
                    }
                }
            } catch (error) {
                logApi('Error: ' + error.message);
                showToast('Error: ' + error.message, 'error');
                SoundManager.play('error');
            } finally {
                btn.classList.remove('loading');
                btn.textContent = 'üíæ Save Score';
            }
        }

        async function getLeaderboard() {
            logApi('Fetching leaderboard...');
            
            const leaderboardContent = document.getElementById('leaderboardContent');
            leaderboardContent.innerHTML = '<p style="text-align: center; padding: 40px;">‚è≥ Loading...</p>';

            try {
                const result = await ScoreboardAPI.getLeaderboard(100);
                
                logApi('Leaderboard response:');
                logApi(JSON.stringify(result, null, 2));

                if (result.success && result.data.length > 0) {
                    displayLeaderboard(result.data);
                    showToast(`Loaded ${result.data.length} scores`, 'success');
                    SoundManager.play('success');
                } else if (result.success && result.data.length === 0) {
                    leaderboardContent.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">No scores yet. Be the first!</p>';
                    showToast('Leaderboard is empty', 'success');
                } else {
                    leaderboardContent.innerHTML = `<p style="text-align: center; color: #ef4444; padding: 40px;">Error: ${result.error}</p>`;
                    showToast(`Failed: ${result.error}`, 'error');
                    SoundManager.play('error');
                }
            } catch (error) {
                logApi('Error: ' + error.message);
                leaderboardContent.innerHTML = `<p style="text-align: center; color: #ef4444; padding: 40px;">Error: ${error.message}</p>`;
                showToast('Error: ' + error.message, 'error');
                SoundManager.play('error');
            }
        }

        function displayLeaderboard(scores) {
            document.getElementById('leaderboardCount').textContent = scores.length;
            
            const table = document.createElement('table');
            table.className = 'leaderboard-table';
            
            table.innerHTML = `
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Player</th>
                        <th>Avatar</th>
                        <th>Score</th>
                        <th>Time</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody>
                    ${scores.map((score, index) => `
                        <tr>
                            <td><strong>${index + 1}</strong></td>
                            <td>${score.name || score.user_name || 'Anonymous'}</td>
                            <td>${score.avatar_code || 'robot'}</td>
                            <td><strong>${score.totale_score || score.score || 0}</strong></td>
                            <td>${score.counter_time || 0}s</td>
                            <td>${score.playedAt ? new Date(score.playedAt).toLocaleDateString() : 'N/A'}</td>
                        </tr>
                    `).join('')}
                </tbody>
            `;
            
            const leaderboardContent = document.getElementById('leaderboardContent');
            leaderboardContent.innerHTML = '';
            leaderboardContent.appendChild(table);
        }

        function logApi(message) {
            const log = document.getElementById('apiResponse');
            const timestamp = new Date().toLocaleTimeString();
            log.innerHTML += `<br>[${timestamp}] ${message}`;
            log.scrollTop = log.scrollHeight;
        }

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `
                <span class="status-indicator status-${type === 'success' ? 'success' : 'error'}"></span>
                <span><strong>${type === 'success' ? 'Success' : 'Error'}:</strong> ${message}</span>
            `;
            
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Initialize with some random data on load
        window.addEventListener('load', () => {
            logSound('Sound Manager initialized');
            logApi('Scoreboard API ready');
            
            // Auto-generate initial data
            setTimeout(() => {
                generateRandomData();
            }, 500);
        });
    </script>
</body>
</html>

